<div id="orders-screen-container">
  <div id="orders-filters">
    <div class="input-data-div">
      <label for="clientFilter">Cliente</label>
      <p-select
        id="clientFilter"
        [(ngModel)]="filters.clientId"
        [options]="clientOptions"
        optionLabel="label"
        optionValue="value"
        placeholder="Selecione um cliente"
        styleClass="input-data"
      />
    </div>
    <div class="input-data-div">
      <p-iftalabel>
        <input
          class="input-data"
          pInputText
          id="status"
          [(ngModel)]="filters.status"
          autocomplete="off"
        />
        <label for="status">Status</label>
      </p-iftalabel>
    </div>
  </div>
  <div class="buttons-div">
    <p-button id="filter-button" (onClick)="applyFilters()">Filtrar</p-button>
    <p-button id="create-button" (onClick)="setOpenCreateModal()"
      >Adicionar</p-button
    >
    <app-order-modal
      [open]="openModal"
      [orderData]="selectedOrder"
      [title]="modalTitle"
      [isVisualizationMode]="isVisualizationMode"
      [clients]="clients"
      (closeModal)="handleModalClose()"
      (saveOrder)="handleOrderSaved($event)"
    />
  </div>
  <div id="orders-table">
    <p-table
      [value]="orders"
      [scrollable]="true"
      [rows]="pageSize"
      [paginator]="true"
      [totalRecords]="totalRecords"
      [lazy]="true"
      (onLazyLoad)="onPageChange($event)"
      [rowsPerPageOptions]="[8, 16, 24]"
    >
      <ng-template #header>
        <tr>
          @for(header of headers; track header){
          <th>{{ header }}</th>
          }
          <th>Ações</th>
        </tr>
      </ng-template>
      <ng-template #body let-order>
        <tr>
          @for(header of headers; track header){ @if (header == 'status' &&
          order.status == "PENDENTE";) {
          <td class="status-chip status-chip-blue">{{ order[header] }}</td>
          } @else if (header == 'status' && (order.status == "APROVADO" ||
          order.status == "ENTREGUE")) {
          <td class="status-chip-green">{{ order[header] }}</td>
          } @else if (header == 'status' && order.status == "CANCELADO") {
          <td class="status-chip-red">{{ order[header] }}</td>
          } @else {
          <td>{{ order[header] }}</td>

          } }
          <td>
            <div style="display: flex; gap: 0.5rem; justify-content: center">
              <button
                style="
                  background: none;
                  border: none;
                  cursor: pointer;
                  padding: 4px;
                  color: rgb(175, 175, 9);
                "
                (click)="setOpenVisualizationModal(order)"
              >
                <i class="pi pi-window-maximize"></i>
              </button>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
<p-toast></p-toast>
